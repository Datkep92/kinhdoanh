<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - H·ªá th·ªëng b√°n h√†ng</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/admin.css">
    <style>
        /* Th√™m CSS m·ªõi cho header layout */
        .admin-header-layout {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            color: white;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo i {
            font-size: 24px;
            color: #60a5fa;
        }

        .logo h2 {
            font-size: 20px;
            font-weight: 600;
            margin: 0;
            color: white;
        }

        .nav-tabs {
            display: flex;
            gap: 5px;
            background: transparent;
            border: none;
            margin-left: 20px;
        }

        .nav-tabs .nav-link {
            color: #cbd5e1;
            background: transparent;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .nav-tabs .nav-link:hover {
            color: white;
            background: rgba(255, 255, 255, 0.1);
        }

        .nav-tabs .nav-link.active {
            color: white;
            background: rgba(96, 165, 250, 0.2);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .user-details h4 {
            font-size: 14px;
            margin: 0;
            font-weight: 600;
        }

        .user-details p {
            font-size: 12px;
            color: #94a3b8;
            margin: 0;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .btn-sync {
            background: rgba(96, 165, 250, 0.1);
            color: #60a5fa;
            border: 1px solid rgba(96, 165, 250, 0.2);
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-sync:hover {
            background: rgba(96, 165, 250, 0.2);
        }

        .btn-logout {
            background: rgba(239, 68, 68, 0.1);
            color: #f87171;
            border: 1px solid rgba(239, 68, 68, 0.2);
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-logout:hover {
            background: rgba(239, 68, 68, 0.2);
        }

        .admin-main-content {
            margin-top: 60px;
            padding: 20px;
            min-height: calc(100vh - 60px);
            background: #f8fafc;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .admin-header-layout {
                padding: 0 10px;
            }

            .logo h2 {
                display: none;
            }

            .nav-tabs {
                margin-left: 10px;
                gap: 2px;
            }

            .nav-tabs .nav-link {
                padding: 8px 12px;
                font-size: 14px;
            }

            .nav-tabs .nav-link span {
                display: none;
            }

            .user-details {
                display: none;
            }

            .btn-sync span, .btn-logout span {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .nav-tabs .nav-link {
                padding: 8px;
            }

            .nav-tabs .nav-link i {
                margin-right: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="admin-header-layout">
        
            
            <div class="nav-tabs">
            
                <button class="nav-link active" data-view="dashboard" id="navDashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>C√°sNa</span>
                </button>
                <button class="nav-link" data-view="hkds" id="navHKDs">
                    <i class="fas fa-store"></i>
                    <span>HKD</span>
                </button>
                <button class="nav-link" data-view="invoices" id="navInvoices">
                    <i class="fas fa-receipt"></i>
                    <span>H√≥a ƒë∆°n</span>
                </button>
                <button class="nav-link" data-view="import" id="navImport">
                    <i class="fas fa-file-import"></i>
                    <span>Import</span>
                </button>
                <button class="nav-link" data-view="settings" id="navSettings">
                    <i class="fas fa-cog"></i>
                    <span>C√†i ƒë·∫∑t</span>
                </button>
            </div>
        </div>
        
        <div class="header-right">
            <div class="user-info">
                
            </div>
            <div id="notificationBadge" class="notification-badge">
                <button class="notification-badge-btn" onclick="toggleNotificationPanel()">
                    <i class="fas fa-bell"></i>
                    <span class="notification-count">0</span>
                </button>
            </div>
            <div class="header-actions">
    <button class="btn-logout" id="btnHardSync" onclick="handleAdminHardSync()">
        <i class="fas fa-redo-alt"></i>
        <span>Sync</span>
    </button>

    <button class="btn-logout" id="btnLogout">
        <i class="fas fa-sign-out-alt"></i>
        <span>ƒêƒÉng xu·∫•t</span>
    </button>
</div>
        </div>
    </header>
    
    <!-- Main content -->
    <main class="admin-main-content">
        <!-- Dashboard Section -->
        <div id="dashboardSection" class="content-section active">
            <div class="section-header">
                <h2>Dashboard</h2>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon hkds">
                            <i class="fas fa-store"></i>
                        </div>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalHKDs">0</h3>
                        <p>T·ªïng s·ªë HKD</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon invoices">
                            <i class="fas fa-receipt"></i>
                        </div>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalInvoices">0</h3>
                        <p>T·ªïng h√≥a ƒë∆°n</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon revenue">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalRevenue">0‚Ç´</h3>
                        <p>T·ªïng doanh thu</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon today">
                            <i class="fas fa-calendar-day"></i>
                        </div>
                    </div>
                    <div class="stat-content">
                        <h3 id="todayInvoices">0</h3>
                        <p>H√≥a ƒë∆°n h√¥m nay</p>
                    </div>
                </div>
            </div>
            
            <div class="section-header">
                <h2>Th·ªëng k√™ doanh thu</h2>
            </div>
            <div id="dashboardChart" class="chart-container">
                <!-- Chart will be rendered here -->
            </div>
            
            
            <div id="recentInvoices" class="invoice-cards">
                <!-- Recent invoices will be loaded here -->
            </div>
        </div>
        
        <!-- HKD Management Section -->
        <div id="hkdsSection" class="content-section">
            <div class="section-header">
                <h2>Qu·∫£n l√Ω H·ªô Kinh Doanh</h2>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addHKDModal" id="btnAddHKD">
                    <i class="fas fa-plus"></i> Th√™m HKD
                </button>
            </div>
            
            <div class="search-container">
                <input type="text" id="hkdSearch" class="search-input" placeholder="T√¨m ki·∫øm HKD theo t√™n, SƒêT, ƒë·ªãa ch·ªâ...">
            </div>
            
            <div id="hkdList" class="hkd-list">
                <!-- HKD list will be loaded here -->
            </div>
        </div>
        
        <!-- Invoices Section -->
        <div id="invoicesSection" class="content-section">
            <div class="section-header">
                <h2>Qu·∫£n l√Ω H√≥a ƒë∆°n</h2>
            </div>
            
            <div class="filter-container">
                <div class="filter-row">
                    <div class="filter-group">
                        <label>HKD:</label>
                        <select id="invoiceHKD" class="form-select">
                            <option value="">T·∫•t c·∫£ HKD</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>T·ª´ ng√†y:</label>
                        <input type="date" id="invoiceStartDate" class="form-control">
                    </div>
                    <div class="filter-group">
                        <label>ƒê·∫øn ng√†y:</label>
                        <input type="date" id="invoiceEndDate" class="form-control">
                    </div>
                    <div class="filter-actions">
                        <button class="btn btn-primary" id="btnFilterInvoices">
                            <i class="fas fa-filter"></i> L·ªçc
                        </button>
                        <button class="btn btn-secondary" id="btnResetFilter">
                            <i class="fas fa-redo"></i> Reset
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="table-responsive">
                <table class="invoice-table">
                    <thead>
                        <tr>
                            <th>Ng√†y gi·ªù</th>
                            <th>M√£ Hƒê</th>
                            <th>HKD</th>
                            <th>Kh√°ch h√†ng</th>
                            <th>S·ªë SP</th>
                            <th>T·ªïng ti·ªÅn</th>
                            <th>Thao t√°c</th>
                        </tr>
                    </thead>
                    <tbody id="invoiceList">
                        <!-- Invoice list will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Import & Management Section -->
        <div id="importSection" class="content-section">
            
            
            <!-- Import Excel Tab -->
            <div id="importTab" class="tab-content active">
                <div class="section-header">
                    <h2>Import Excel</h2>
                </div>
                
                <div class="import-container">
                    <div class="import-options">
                        <div class="import-option">
                            <label>Ch·ªçn HKD:</label>
                            <select id="importHKD" class="form-select" required>
                                <option value="">Ch·ªçn HKD...</option>
                            </select>
                        </div>
                        
                        <div class="import-option">
                            <label>Ch·∫ø ƒë·ªô import:</label>
                            <select id="importMode" class="form-select">
                                <option value="append">B·ªï sung h√†ng h√≥a</option>
                                <option value="replace">Ghi ƒë√® to√†n b·ªô</option>
                            </select>
                        </div>
                        
                        <div class="import-option">
                            <label>Ch·ªçn file Excel:</label>
                            <div class="file-input-wrapper">
                                <input type="file" id="importExcel" class="form-control" accept=".xlsx,.xls,.csv">
                                <button class="btn btn-outline-secondary" onclick="document.getElementById('importExcel').click()">
                                    <i class="fas fa-file-excel"></i> Ch·ªçn file
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="import-preview">
                        <h5>Preview d·ªØ li·ªáu:</h5>
                        <div id="excelPreview" class="excel-preview">
                            <!-- Excel preview will be shown here -->
                        </div>
                    </div>
                    
                    <div class="import-actions">
                        <button class="btn btn-secondary" onclick="clearExcelPreview()">
                            <i class="fas fa-times"></i> H·ªßy
                        </button>
                        <button class="btn btn-primary" id="btnImport">
                            <i class="fas fa-upload"></i> Import
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Management Tab -->
            <div id="managementTab" class="tab-content">
                <div class="section-header">
                    <h2>Qu·∫£n l√Ω Danh m·ª•c & H√†ng h√≥a</h2>
                </div>
                
                <div class="management-container">
                    <div class="management-controls">
                        <div class="control-group">
                            <label>Ch·ªçn HKD:</label>
                            <select id="manageHKD" class="form-select">
                                <option value="">Ch·ªçn HKD...</option>
                            </select>
                        </div>
                        
                        <div class="control-actions">
                            <button class="btn btn-primary" id="btnLoadProducts">
                                <i class="fas fa-sync"></i> T·∫£i d·ªØ li·ªáu
                            </button>
                            <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addCategoryModal">
                                <i class="fas fa-folder-plus"></i> Th√™m danh m·ª•c
                            </button>
                            <button class="btn btn-info" data-bs-toggle="modal" data-bs-target="#addProductModal">
                                <i class="fas fa-box"></i> Th√™m h√†ng h√≥a
                            </button>
                        </div>
                    </div>
                    
                    <div class="management-content">
                        <!-- Categories Section -->
                        <div class="categories-section">
                            <div class="section-header">
                                <h5>Danh m·ª•c</h5>
                                <small id="categoriesCount">0 danh m·ª•c</small>
                            </div>
                            <div id="categoriesList" class="categories-list">
                                <div class="no-data">
                                    <i class="fas fa-folder-open"></i>
                                    <p>Ch∆∞a ch·ªçn HKD ho·∫∑c ch∆∞a c√≥ danh m·ª•c</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Products Section -->
                        <div class="products-section">
                            <div class="section-header">
                                <h5>H√†ng h√≥a</h5>
                                <small id="productsCount">0 h√†ng h√≥a</small>
                            </div>
                            
                            <div class="products-filter">
                                <div class="filter-group">
                                    <label>Danh m·ª•c:</label>
                                    <select id="filterCategory" class="form-select">
                                        <option value="">T·∫•t c·∫£ danh m·ª•c</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label>T√¨m ki·∫øm:</label>
                                    <div class="search-wrapper">
                                        <input type="text" id="searchProduct" class="form-control" placeholder="T√™n ho·∫∑c m√£ s·∫£n ph·∫©m...">
                                        <i class="fas fa-search"></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="table-responsive">
                                <table class="products-table">
                                    <thead>
                                        <tr>
                                            <th>MSP</th>
                                            <th>T√™n h√†ng h√≥a</th>
                                            <th>Danh m·ª•c</th>
                                            <th>ƒêVT</th>
                                            <th>Gi√° b√°n</th>
                                            <th>T·ªìn kho</th>
                                            <th>Thao t√°c</th>
                                        </tr>
                                    </thead>
                                    <tbody id="productsList">
                                        <tr>
                                            <td colspan="7" class="text-center no-data">
                                                <i class="fas fa-box-open"></i>
                                                <p>Ch∆∞a ch·ªçn HKD ho·∫∑c ch∆∞a c√≥ h√†ng h√≥a</p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="table-footer">
                                <div class="pagination-info">
                                    Hi·ªÉn th·ªã <span id="showingCount">0</span> tr√™n <span id="totalCount">0</span> h√†ng h√≥a
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Settings Section -->
        <div id="settingsSection" class="content-section">
            <div class="section-header">
                <h2>C√†i ƒë·∫∑t h·ªá th·ªëng</h2>
            </div>
            
            <div class="settings-container">
                <div class="settings-card">
                    <h4>ƒê·ªïi m·∫≠t kh·∫©u Admin</h4>
                    <form id="changePasswordForm" class="settings-form">
                        <div class="form-group">
                            <label>M·∫≠t kh·∫©u c≈©:</label>
                            <input type="password" id="oldPassword" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label>M·∫≠t kh·∫©u m·ªõi:</label>
                            <input type="password" id="newPassword" class="form-control" required minlength="6">
                        </div>
                        
                        <div class="form-group">
                            <label>X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi:</label>
                            <input type="password" id="confirmPassword" class="form-control" required minlength="6">
                        </div>
                        
                        <button type="submit" class="btn btn-primary" id="btnChangePassword">
                            <i class="fas fa-save"></i> ƒê·ªïi m·∫≠t kh·∫©u
                        </button>
                    </form>
                </div>
                
                <div class="settings-card">
                    <h4>Th√¥ng tin h·ªá th·ªëng</h4>
                    <div class="system-info">
                        <div class="info-item">
                            <label>Phi√™n b·∫£n:</label>
                            <span>1.0.0</span>
                        </div>
                        <div class="info-item">
                            <label>Tr·∫°ng th√°i ƒë·ªìng b·ªô:</label>
                            <span id="syncStatus">ƒêang ƒë·ªìng b·ªô...</span>
                        </div>
                        <div class="info-item">
                            <label>Dung l∆∞·ª£ng s·ª≠ d·ª•ng:</label>
                            <span id="storageUsage">ƒêang t√≠nh...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Modals -->
    
    <!-- Add HKD Modal -->
    <div class="modal fade" id="addHKDModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Th√™m HKD m·ªõi</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="hkdForm">
                        <div class="form-group mb-3">
                            <label class="form-label">T√™n HKD *</label>
                            <input type="text" id="hkdName" class="form-control" required>
                        </div>
                        <div class="form-group mb-3">
                            <label class="form-label">S·ªë ƒëi·ªán tho·∫°i *</label>
                            <input type="tel" id="hkdPhone" class="form-control" required>
                        </div>
                        <div class="form-group mb-3">
                            <label class="form-label">ƒê·ªãa ch·ªâ</label>
                            <input type="text" id="hkdAddress" class="form-control">
                        </div>
                        <div class="form-group mb-3">
                            <label class="form-label">M·∫≠t kh·∫©u *</label>
                            <input type="password" id="hkdPassword" class="form-control" required minlength="6">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                    <button type="button" class="btn btn-primary" id="saveHKD">L∆∞u</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Edit HKD Modal -->
    <div class="modal fade" id="editHKDModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Ch·ªânh s·ª≠a HKD</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editHKDForm">
                        <div class="mb-3">
                            <label class="form-label">T√™n HKD *</label>
                            <input type="text" class="form-control" id="editHKDName" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">S·ªë ƒëi·ªán tho·∫°i *</label>
                            <input type="tel" class="form-control" id="editHKDPhone" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">ƒê·ªãa ch·ªâ</label>
                            <input type="text" class="form-control" id="editHKDAddress">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">M·∫≠t kh·∫©u m·ªõi (ƒë·ªÉ tr·ªëng n·∫øu kh√¥ng ƒë·ªïi)</label>
                            <input type="password" class="form-control" id="editHKDPassword">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                    <button type="button" class="btn btn-primary" id="updateHKD">C·∫≠p nh·∫≠t</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Invoice Detail Modal -->
    <div class="modal fade" id="invoiceDetailModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="invoiceDetailTitle">Chi ti·∫øt h√≥a ƒë∆°n</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="invoice-detail-info mb-4">
                        <div class="row">
                            <div class="col-md-6">
                                <p><strong>Ng√†y:</strong> <span id="invoiceDetailDate"></span></p>
                                <p><strong>HKD:</strong> <span id="invoiceDetailHKD"></span></p>
                            </div>
                            <div class="col-md-6">
                                <p><strong>Kh√°ch h√†ng:</strong> <span id="invoiceDetailCustomer"></span></p>
                                <p><strong>Tr·∫°ng th√°i:</strong> <span id="invoiceDetailStatus"></span></p>
                            </div>
                        </div>
                    </div>
                    
                    <h6>Chi ti·∫øt s·∫£n ph·∫©m:</h6>
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>T√™n s·∫£n ph·∫©m</th>
                                    <th>ƒêVT</th>
                                    <th>S·ªë l∆∞·ª£ng</th>
                                    <th>ƒê∆°n gi√°</th>
                                    <th>Th√†nh ti·ªÅn</th>
                                </tr>
                            </thead>
                            <tbody id="invoiceDetailItems">
                                <!-- Invoice items will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="invoice-total text-end mt-4">
                        <h5>T·ªïng c·ªông: <span id="invoiceDetailTotal" class="text-primary"></span></h5>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add Category Modal -->
    <div class="modal fade" id="addCategoryModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="categoryModalTitle">Th√™m danh m·ª•c m·ªõi</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addCategoryForm">
                        <div class="mb-3">
                            <label class="form-label">T√™n danh m·ª•c *</label>
                            <input type="text" class="form-control" id="categoryName" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">M√¥ t·∫£</label>
                            <textarea class="form-control" id="categoryDescription" rows="3"></textarea>
                        </div>
                        <input type="hidden" id="editCategoryId">
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                    <button type="button" class="btn btn-primary" id="btnSaveCategory">L∆∞u</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add/Edit Product Modal -->
    <div class="modal fade" id="addProductModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="productModalTitle">Th√™m h√†ng h√≥a m·ªõi</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="productForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">M√£ s·∫£n ph·∫©m *</label>
                                <input type="text" class="form-control" id="productCode" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">T√™n h√†ng h√≥a *</label>
                                <input type="text" class="form-control" id="productName" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Danh m·ª•c *</label>
                                <select class="form-select" id="productCategory" required>
                                    <option value="">Ch·ªçn danh m·ª•c...</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">ƒê∆°n v·ªã t√≠nh *</label>
                                <input type="text" class="form-control" id="productUnit" value="c√°i" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Gi√° b√°n *</label>
                                <input type="number" class="form-control" id="productPrice" min="0" required>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">S·ªë l∆∞·ª£ng t·ªìn</label>
                                <input type="number" class="form-control" id="productStock" min="0" value="0">
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Gi√° nh·∫≠p (n·∫øu c√≥)</label>
                                <input type="number" class="form-control" id="productCost" min="0">
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">M√¥ t·∫£</label>
                            <textarea class="form-control" id="productDescription" rows="3"></textarea>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Ghi ch√∫</label>
                            <textarea class="form-control" id="productNote" rows="2"></textarea>
                        </div>
                        
                        <input type="hidden" id="editProductId">
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                    <button type="button" class="btn btn-primary" id="btnSaveProduct">L∆∞u</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Delete Confirmation Modal -->
    <div class="modal fade" id="confirmDeleteModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">X√°c nh·∫≠n x√≥a</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p id="deleteMessage">B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a?</p>
                    <input type="hidden" id="deleteItemId">
                    <input type="hidden" id="deleteItemType">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                    <button type="button" class="btn btn-danger" id="btnConfirmDelete">X√≥a</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <!-- App scripts -->
    <script src="js/firebase-config.js"></script>
    <script src="js/indexedDB.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/sync-manager.js"></script>
    <script src="js/notification-manager.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/init.js"></script>
    <script src="js/admin.js"></script>
    
    <script>
    // Initialize admin page
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Admin page DOM loaded');
        initAdminPage();
        
        // Tab navigation for import/management
        setupTabNavigation();
    });
    
    // Tab navigation
    function setupTabNavigation() {
        const tabBtns = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                const tabId = this.dataset.tab;
                
                // Remove active class from all buttons and contents
                tabBtns.forEach(b => b.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));
                
                // Add active class to clicked button and corresponding content
                this.classList.add('active');
                document.getElementById(`${tabId}Tab`).classList.add('active');
            });
        });
    }
    
    function switchAdminView(view) {
        console.log('üîÑ Switching to view:', view);
        
        if (!view) {
            console.error('‚ùå View is undefined! Defaulting to dashboard');
            view = 'dashboard';
        }
        
        currentAdminView = view;
        
        // ·∫®n t·∫•t c·∫£ sections
        document.querySelectorAll('.content-section').forEach(section => {
            section.classList.remove('active');
        });
        
        // X√≥a active class t·ª´ t·∫•t c·∫£ nav links
        document.querySelectorAll('.nav-link').forEach(link => {
            link.classList.remove('active');
        });
        
        // Hi·ªÉn th·ªã section ƒë∆∞·ª£c ch·ªçn
        const targetSection = document.getElementById(`${view}Section`);
        if (targetSection) {
            targetSection.classList.add('active');
            console.log(`‚úÖ Hi·ªÉn th·ªã section: ${view}Section`);
        } else {
            console.error(`‚ùå Kh√¥ng t√¨m th·∫•y section: ${view}Section`);
            const dashboardSection = document.getElementById('dashboardSection');
            if (dashboardSection) {
                dashboardSection.classList.add('active');
                view = 'dashboard';
                console.log('üîÑ Fallback: hi·ªÉn th·ªã dashboard');
            }
        }
        
        // Th√™m active class cho nav link
        const activeLink = document.querySelector(`.nav-link[data-view="${view}"]`);
        if (activeLink) {
            activeLink.classList.add('active');
        }
        
        // T·∫£i d·ªØ li·ªáu cho view
        try {
            switch(view) {
                case 'dashboard':
                    if (typeof showDashboard === 'function') showDashboard();
                    break;
                case 'hkds':
                    if (typeof showHKDs === 'function') showHKDs();
                    break;
                case 'invoices':
                    if (typeof showInvoices === 'function') showInvoices();
                    break;
                case 'import':
                    if (typeof showImport === 'function') showImport();
                    break;
                case 'settings':
                    if (typeof showSettings === 'function') showSettings();
                    break;
            }
        } catch (error) {
            console.error(`‚ùå L·ªói khi t·∫£i view ${view}:`, error);
        }
    }
    
    // Make functions available globally
    window.resetInvoiceFilter = function() {
        document.getElementById('invoiceHKD').value = '';
        document.getElementById('invoiceStartDate').value = '';
        document.getElementById('invoiceEndDate').value = '';
        if (typeof filterInvoices === 'function') {
            filterInvoices();
        }
    };
    
    window.clearExcelPreview = function() {
        document.getElementById('excelPreview').innerHTML = '';
        document.getElementById('importExcel').value = '';
        delete window.excelData;
        Utils.showToast('ƒê√£ x√≥a preview', 'info');
    };
    
    window.forceSync = function() {
        if (typeof syncData === 'function') {
            Utils.showToast('ƒêang ƒë·ªìng b·ªô d·ªØ li·ªáu...', 'info');
            syncData(true).then(() => {
                Utils.showToast('ƒê·ªìng b·ªô ho√†n t·∫•t', 'success');
            }).catch(() => {
                Utils.showToast('L·ªói ƒë·ªìng b·ªô', 'error');
            });
        }
    };
    
    window.switchAdminView = switchAdminView;
    window.setupTabNavigation = setupTabNavigation;
    
    </script>
</body>
</html>